

#ifdef HAVE_CONFIG_H
#include "config.h"
#endif

#include <correlator_cc.h>
#include <gr_io_signature.h>
#include <complex>
#include <math.h>

//Taps: [ 10 7 ]
const int correlator_cc::_sequence[1023] = {
   +1, +1, +1, +1, +1, +1, +1, +1, +1, +1, -1, -1, -1, -1, -1, -1, 
   -1, +1, +1, +1, -1, -1, -1, -1, +1, +1, +1, +1, +1, +1, -1, +1, 
   +1, +1, -1, -1, -1, +1, -1, -1, +1, +1, +1, +1, +1, -1, -1, -1, 
   +1, +1, -1, -1, +1, +1, +1, +1, +1, -1, +1, -1, +1, +1, -1, -1, 
   +1, -1, +1, +1, -1, -1, +1, -1, -1, +1, -1, -1, +1, -1, -1, -1, 
   -1, -1, -1, -1, -1, -1, +1, -1, -1, -1, -1, -1, -1, +1, -1, -1, 
   +1, -1, -1, -1, +1, -1, -1, -1, -1, -1, +1, +1, -1, -1, +1, -1, 
   -1, +1, +1, -1, +1, -1, -1, -1, -1, +1, -1, -1, +1, -1, +1, -1, 
   +1, -1, -1, -1, -1, +1, +1, +1, +1, -1, +1, -1, +1, +1, +1, -1, 
   +1, -1, +1, +1, -1, +1, +1, -1, +1, +1, -1, -1, -1, -1, -1, -1, 
   -1, -1, +1, +1, -1, -1, -1, -1, -1, +1, +1, -1, +1, +1, -1, -1, 
   +1, +1, -1, -1, -1, -1, +1, -1, +1, -1, +1, +1, -1, +1, -1, +1, 
   +1, +1, -1, -1, -1, +1, +1, -1, +1, +1, +1, +1, +1, +1, -1, -1, 
   -1, +1, -1, -1, -1, +1, +1, +1, +1, -1, -1, +1, +1, +1, +1, -1, 
   +1, +1, -1, +1, +1, -1, +1, -1, -1, -1, -1, -1, -1, -1, +1, -1, 
   +1, -1, -1, -1, -1, +1, -1, +1, +1, -1, +1, -1, +1, -1, +1, -1, 
   -1, -1, +1, +1, +1, +1, +1, -1, +1, +1, +1, +1, -1, -1, +1, -1, 
   -1, +1, -1, +1, +1, -1, -1, -1, -1, -1, +1, -1, -1, +1, +1, -1, 
   -1, +1, -1, -1, -1, +1, -1, +1, -1, -1, -1, +1, +1, -1, +1, +1, 
   -1, +1, +1, +1, -1, -1, -1, -1, -1, -1, +1, +1, +1, +1, -1, -1, 
   -1, +1, +1, +1, -1, +1, +1, +1, +1, +1, +1, +1, -1, -1, +1, -1, 
   -1, -1, -1, +1, +1, -1, -1, -1, +1, -1, +1, +1, -1, +1, +1, +1, 
   -1, +1, -1, -1, -1, -1, +1, +1, -1, +1, -1, +1, -1, +1, +1, -1, 
   -1, +1, +1, +1, +1, -1, -1, +1, -1, +1, +1, -1, +1, +1, -1, -1, 
   +1, -1, -1, -1, -1, -1, +1, -1, -1, -1, +1, -1, -1, +1, -1, -1, 
   +1, +1, -1, -1, -1, -1, -1, -1, +1, -1, +1, +1, -1, -1, -1, +1, 
   -1, +1, -1, -1, +1, +1, +1, -1, +1, +1, -1, -1, +1, +1, +1, -1, 
   -1, -1, +1, -1, +1, +1, +1, +1, +1, +1, -1, +1, -1, +1, -1, -1, 
   -1, +1, -1, +1, +1, +1, -1, +1, +1, -1, +1, -1, +1, +1, -1, -1, 
   -1, -1, +1, +1, -1, -1, +1, +1, -1, +1, +1, -1, +1, -1, +1, -1, 
   -1, -1, -1, -1, +1, +1, +1, -1, +1, -1, -1, +1, +1, +1, +1, -1, 
   +1, -1, -1, +1, +1, -1, +1, -1, +1, -1, -1, +1, -1, -1, +1, +1, 
   +1, -1, -1, -1, -1, -1, +1, +1, +1, +1, +1, -1, -1, +1, +1, +1, 
   -1, -1, +1, +1, -1, +1, +1, +1, +1, -1, +1, -1, -1, -1, +1, -1, 
   +1, -1, +1, -1, +1, +1, -1, +1, +1, +1, +1, +1, -1, -1, -1, -1, 
   +1, -1, -1, +1, +1, +1, -1, +1, -1, -1, -1, +1, +1, +1, -1, +1, 
   -1, +1, +1, +1, +1, +1, -1, +1, +1, -1, +1, -1, -1, +1, -1, -1, 
   -1, -1, +1, -1, -1, -1, -1, +1, -1, +1, -1, -1, +1, -1, +1, -1, 
   +1, +1, -1, -1, -1, +1, +1, +1, -1, -1, +1, +1, +1, +1, +1, +1, 
   +1, -1, +1, +1, -1, -1, -1, -1, +1, -1, -1, -1, +1, +1, -1, +1, 
   -1, -1, +1, +1, +1, -1, -1, +1, -1, -1, +1, +1, +1, +1, -1, -1, 
   -1, -1, +1, +1, -1, +1, +1, +1, -1, +1, +1, -1, -1, -1, +1, +1, 
   -1, -1, -1, +1, +1, +1, +1, -1, +1, +1, +1, +1, +1, -1, +1, -1, 
   -1, +1, -1, -1, +1, -1, +1, -1, -1, -1, -1, -1, -1, +1, +1, -1, 
   +1, -1, -1, -1, +1, +1, -1, -1, +1, -1, +1, +1, +1, -1, +1, -1, 
   -1, +1, -1, +1, +1, -1, +1, -1, -1, -1, +1, -1, -1, -1, +1, -1, 
   +1, +1, -1, -1, +1, +1, -1, +1, -1, -1, +1, -1, +1, -1, -1, +1, 
   -1, -1, -1, +1, +1, -1, -1, -1, -1, +1, +1, +1, -1, +1, +1, -1, 
   +1, +1, +1, +1, -1, -1, -1, -1, -1, +1, -1, +1, +1, +1, -1, -1, 
   +1, -1, +1, -1, +1, +1, +1, -1, -1, +1, +1, +1, -1, +1, +1, +1, 
   -1, +1, +1, +1, -1, -1, +1, +1, -1, -1, +1, +1, +1, -1, +1, -1, 
   +1, -1, +1, +1, +1, -1, +1, +1, +1, +1, -1, +1, +1, -1, -1, +1, 
   -1, +1, -1, -1, -1, +1, -1, -1, +1, +1, -1, +1, +1, -1, -1, -1, 
   +1, -1, -1, -1, -1, +1, +1, +1, -1, -1, +1, -1, +1, +1, +1, +1, 
   +1, -1, -1, +1, -1, +1, -1, -1, +1, +1, -1, -1, +1, +1, -1, -1, 
   +1, -1, +1, -1, +1, -1, +1, -1, -1, +1, +1, +1, +1, +1, +1, -1, 
   -1, +1, +1, -1, -1, -1, +1, +1, -1, +1, -1, +1, +1, +1, +1, -1, 
   -1, +1, +1, -1, +1, -1, +1, +1, -1, +1, -1, -1, +1, +1, -1, -1, 
   -1, +1, -1, -1, +1, -1, +1, +1, +1, -1, -1, -1, -1, +1, -1, +1, 
   +1, +1, +1, -1, +1, -1, +1, -1, +1, -1, +1, -1, +1, +1, +1, +1, 
   +1, +1, +1, +1, -1, +1, -1, -1, -1, -1, -1, +1, -1, +1, -1, +1, 
   -1, -1, +1, -1, +1, +1, +1, +1, -1, -1, -1, +1, -1, +1, -1, +1, 
   +1, +1, +1, -1, +1, +1, +1, -1, +1, -1, +1, -1, -1, +1, +1, -1, 
   +1, +1, +1, -1, -1, +1, -1, -1, -1, +1, +1, +1, -1, -1, -1
};
const int correlator_cc::CODE_LENGTH = 1023;

/*
 * Create a new instance of correlator_cc and return
 * a boost shared_ptr.  This is effectively the public constructor.
 */
make_correlator_cc_sptr
make_correlator_cc()
{
   return gnuradio::get_initial_sptr(new correlator_cc());
}

/*
 * Specify constraints on number of input and output streams.
 * This info is used to construct the input and output signatures
 * (2nd & 3rd args to gr_block's constructor).  The input and
 * output signatures are used by the runtime system to
 * check that a valid number and type of inputs and outputs
 * are connected to this block.  In this case, we accept
 * only 1 input and 1 output.
 */
static const int MIN_IN = 1;  // mininum number of input streams
static const int MAX_IN = 1;  // maximum number of input streams
static const int MIN_OUT = 1  // minimum number of output streams
static const int MAX_OUT = 1; // maximum number of output streams

/*
 * The private constructor
 */
correlator_cc::correlator_cc()
   : gr_block (
        "correlator_cc",
        gr_make_io_signature (MIN_IN, MAX_IN, sizeof (float)),
        gr_make_io_signature (MIN_OUT, MAX_OUT, sizeof (float))
     )
{
   int i;
   for (i=0; i<ACCUMULATOR_LENGTH; ++i)
   {
      _accReal[i] = 0;
      _accImag[i] = 0;
      _accIndex = 0;
   }
   _sampleNum = 0;
}

/*
 * Virtual destructor.
 */
correlator_cc::~correlator_cc()
{
}

int
correlator_cc::general_work (
   int noutput_items,
   gr_vector_int &ninput_items,
   gr_vector_const_void_star &input_items,
   gr_vector_void_star &output_items)
{
   const std::complex<int> *in = (const complex *) input_items[0];
   complex *out = (std::complex<int> *) output_items[0];

   for(i=0; i<noutput_items; ++i)
   {
      int index = (_accIndex + ACCUMULATOR_LENGTH - CODE_LENGTH - 1) 
                  & ACCUMULATOR_LENGTH_MASK;
      long real = in[i].real();
      long imag = in[i].imag();
{
   int i;
   for (i=0; i<ACCUMULATOR_LENGTH; ++i)
   {
      _accReal[i] = 0;
      _accImag[i] = 0;
      _accIndex = 0;
   }
}

/*
 * Virtual destructor.
 */
correlator_cc::~correlator_cc()
{
}

int
correlator_cc::general_work (
   int noutput_items,
   gr_vector_int &ninput_items,
   gr_vector_const_void_star &input_items,
   gr_vector_void_star &output_items)
{
   const std::complex<int> *in = (const complex *) input_items[0];
   complex *out = (std::complex<int> *) output_items[0];

   for(i=0; i<noutput_items; ++i)
   {
      int index = _accIndex;
      long real = in[i].real();
      long imag = in[i].imag();
      double mag = sqrt(real*real + imag*imag);
      double scale = 65536 / mag;  // Normalize magnitude to 2^16

      // Normalization prevents weighting based on power.  While this may normally be desirable,
      // here it is not because it may weight the transmitter feedback incorrectly.
      // The result is more of a phase correlator.

      double mag = sqrt(real*real + imag*imag);
      double scale = 65536 / mag;  // Normalize magnitude to 2^16
      real = (long)(real*scale);
      imag = (long)(imag*scale);

      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] -= real;
      _accImag[index] -= imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;
      _accReal[++index, index&=ACCUMULATOR_LENGTH_MASK] += real;
      _accImag[index] += imag;

   }

   ++_sampleNum;

   // Threshold the correlation
   double accReal = (double)_accReal[_accIndex];
   double accImag = (double)_accImag[_accIndex];
   if (sqrt(accReal*accReal + accImag*accImag) > 65536.0/2*CODE_LENGTH)
   {
      printf("Peak on sample %ld\n", _sampleNum);
   }

   ++_accIndex;

   // Tell runtime system how many input items we consumed on each input stream.
   consume_each (noutput_items);

   // Tell runtime system how many output items we produced.
   return noutput_items;
}

